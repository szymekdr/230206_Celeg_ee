<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Szymek Drobniak">
<meta name="dcterms.date" content="2023-02-24">

<title>C. elegans analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="code_files/libs/clipboard/clipboard.min.js"></script>
<script src="code_files/libs/quarto-html/quarto.js"></script>
<script src="code_files/libs/quarto-html/popper.min.js"></script>
<script src="code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="code_files/libs/quarto-html/anchor.min.js"></script>
<link href="code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">C. elegans analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Szymek Drobniak </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 24, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkDepPackageVersion(dep_pkg = "TMB"): Package version inconsistency detected.
glmmTMB was built with TMB version 1.9.1
Current TMB version is 1.9.2
Please re-install glmmTMB from source or restore original 'TMB' package (see '?reinstalling' for more information)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(asreml)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Online License checked out Fri Feb 24 15:50:13 2023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metafor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data wrangling</h2>
<p>Restructuring the data to calculate fitness difference (effect size).</p>
<p>First load the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>alldata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"all.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">head =</span> T, <span class="at">stringsAsFactors =</span> T)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ancdata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"anc.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">head =</span> T, <span class="at">stringsAsFactors =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summarise the non-ancestral data to have means in each of 4 repeats:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anc_pop <span class="sc">!=</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(block_unique) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Nstart =</span> <span class="fu">mean</span>(propN_start),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_N1 =</span> <span class="fu">mean</span>(propN_F1),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD_Nstart =</span> <span class="fu">sd</span>(propN_start),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD_N1 =</span> <span class="fu">sd</span>(propN_F1),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">population =</span> <span class="fu">unique</span>(population),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">isoline =</span> <span class="fu">unique</span>(isoline),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">temperature =</span> <span class="fu">unique</span>(temperature),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">repr.type =</span> <span class="fu">unique</span>(repr.type),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">anc_pop =</span> <span class="fu">unique</span>(anc_pop),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Summarise the ancestral data to have means in each of 4 repeats:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ancdata_2 <span class="ot">&lt;-</span> ancdata <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(block_unique) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Nstart_anc =</span> <span class="fu">mean</span>(propN_start),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_N1_anc =</span> <span class="fu">mean</span>(propN_F1),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD_Nstart_anc =</span> <span class="fu">sd</span>(propN_start),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD_N1_anc =</span> <span class="fu">sd</span>(propN_F1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Merge actual data and ancestral data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata_2 <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ancdata_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"anc_pop"</span> <span class="ot">=</span> <span class="st">"block_unique"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>anc_pop)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(alldata_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 13
$ block_unique    &lt;fct&gt; I.I_E02_Iz6, I.I_E05_Iz6, I.I_E06_Iz6, I.I_E08_Iz6, I.…
$ mean_Nstart     &lt;dbl&gt; 0.5818966, 0.5750916, 0.7437037, 0.6898734, 0.6875000,…
$ mean_N1         &lt;dbl&gt; 0.3776727, 0.4294794, 0.5099959, 0.3424359, 0.4647014,…
$ SD_Nstart       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ SD_N1           &lt;dbl&gt; 0.05545831, 0.05415434, 0.02281169, 0.02699229, 0.0166…
$ population      &lt;fct&gt; E02, E05, E06, E08, E09, E73, E74, E75, K11, K32, K60,…
$ isoline         &lt;fct&gt; Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6,…
$ temperature     &lt;fct&gt; 24C, 24C, 24C, 24C, 24C, 24C, 24C, 24C, 20C, 20C, 20C,…
$ repr.type       &lt;fct&gt; FOG, FOG, FOG, FOG, FOG, WT, WT, WT, WT, WT, FOG, FOG,…
$ mean_Nstart_anc &lt;dbl&gt; 0.5939742, 0.5939742, 0.5939742, 0.5939742, 0.5939742,…
$ mean_N1_anc     &lt;dbl&gt; 0.3680913, 0.3680913, 0.3680913, 0.3680913, 0.3680913,…
$ SD_Nstart_anc   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ SD_N1_anc       &lt;dbl&gt; 0.025064967, 0.025064967, 0.025064967, 0.025064967, 0.…</code></pre>
</div>
</div>
</section>
<section id="effect-sizes" class="level2">
<h2 class="anchored" data-anchor-id="effect-sizes">Effect sizes</h2>
<p>We will use two types of fitness measures (for now without explicit errors): proportion difference and (natural log) of proportion ratio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata_2 <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitness_ee_1 =</span> mean_N1 <span class="sc">-</span> mean_Nstart,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_ee_2 =</span> mean_N1<span class="sc">/</span>mean_Nstart,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_ee_3 =</span> <span class="fu">log</span>(mean_N1<span class="sc">/</span>mean_Nstart),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_anc_1 =</span> mean_N1_anc <span class="sc">-</span> mean_Nstart_anc,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_anc_2 =</span> mean_N1_anc<span class="sc">/</span>mean_Nstart_anc,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_anc_3 =</span> <span class="fu">log</span>(mean_N1_anc<span class="sc">/</span>mean_Nstart_anc),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">repr.type =</span> <span class="fu">relevel</span>(repr.type, <span class="at">ref =</span> <span class="st">"WT"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see the properties of these measures:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alldata_2) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitness_ee_1), <span class="at">colour =</span> <span class="st">"brown"</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitness_ee_2), <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitness_ee_3), <span class="at">colour =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alldata_2) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitness_anc_1), <span class="at">colour =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitness_anc_2), <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitness_anc_3), <span class="at">colour =</span> <span class="st">"turquoise"</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As expected - the <code>log(proportion_1/proportion_0)</code> has much better distributional properties.</p>
<p>Let’s turn it into a simple effect size (fitness difference, for now without any sampling variance calculation):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata_2 <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_1 =</span> fitness_ee_1 <span class="sc">-</span> fitness_anc_1,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_2 =</span> fitness_ee_2 <span class="sc">-</span> fitness_anc_2,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> fitness_ee_3 <span class="sc">-</span> fitness_anc_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="analysis-using-lmer" class="level2">
<h2 class="anchored" data-anchor-id="analysis-using-lmer">Analysis using <code>lmer()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d_1 <span class="sc">~</span> isoline <span class="sc">*</span> temperature <span class="sc">*</span> repr.type <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>population), <span class="at">data =</span> alldata_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d_2 <span class="sc">~</span> isoline <span class="sc">*</span> temperature <span class="sc">*</span> repr.type <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>population), <span class="at">data =</span> alldata_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d_3 <span class="sc">~</span> isoline <span class="sc">*</span> temperature <span class="sc">*</span> repr.type <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>population), <span class="at">data =</span> alldata_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: d_1 ~ isoline * temperature * repr.type + (1 | population)
   Data: alldata_2

REML criterion at convergence: -144.9

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.00316 -0.59848  0.05253  0.58230  2.86831 

Random effects:
 Groups     Name        Variance Std.Dev.
 population (Intercept) 0.000000 0.00000 
 Residual               0.005085 0.07131 
Number of obs: 80, groups:  population, 35

Fixed effects:
                                       Estimate Std. Error       df t value
(Intercept)                            -0.04438    0.02521 68.00000  -1.760
isolineIz8                              0.03813    0.03851 68.00000   0.990
isolineIz9                              0.18667    0.04367 68.00000   4.275
temperature24C                          0.03371    0.03382 68.00000   0.997
repr.typeFOG                            0.06055    0.03851 68.00000   1.572
isolineIz8:temperature24C              -0.05396    0.05712 68.00000  -0.945
isolineIz9:temperature24C              -0.14368    0.05712 68.00000  -2.515
isolineIz8:repr.typeFOG                -0.08151    0.05446 68.00000  -1.497
isolineIz9:repr.typeFOG                -0.06854    0.06345 68.00000  -1.080
temperature24C:repr.typeFOG            -0.05268    0.04806 68.00000  -1.096
isolineIz8:temperature24C:repr.typeFOG  0.16047    0.07688 68.00000   2.087
isolineIz9:temperature24C:repr.typeFOG  0.22186    0.09078 68.00000   2.444
                                       Pr(&gt;|t|)    
(Intercept)                              0.0828 .  
isolineIz8                               0.3256    
isolineIz9                             6.11e-05 ***
temperature24C                           0.3225    
repr.typeFOG                             0.1205    
isolineIz8:temperature24C                0.3482    
isolineIz9:temperature24C                0.0143 *  
isolineIz8:repr.typeFOG                  0.1391    
isolineIz9:repr.typeFOG                  0.2838    
temperature24C:repr.typeFOG              0.2769    
isolineIz8:temperature24C:repr.typeFOG   0.0406 *  
isolineIz9:temperature24C:repr.typeFOG   0.0171 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) islnI8 islnI9 tmp24C rp.FOG isI8:24C isI9:24C iI8:.F iI9:.F
isolineIz8  -0.655                                                            
isolineIz9  -0.577  0.378                                                     
tempertr24C -0.745  0.488  0.430                                              
repr.typFOG -0.655  0.429  0.378  0.488                                       
islnIz8:24C  0.441 -0.674 -0.255 -0.592 -0.289                                
islnIz9:24C  0.441 -0.289 -0.764 -0.592 -0.289  0.351                         
islnI8:.FOG  0.463 -0.707 -0.267 -0.345 -0.707  0.477    0.204                
islnI9:.FOG  0.397 -0.260 -0.688 -0.296 -0.607  0.175    0.526    0.429       
tmp24C:.FOG  0.525 -0.343 -0.303 -0.704 -0.801  0.417    0.417    0.567  0.486
iI8:24C:.FO -0.328  0.501  0.189  0.440  0.501 -0.743   -0.261   -0.708 -0.304
iI9:24C:.FO -0.278  0.182  0.481  0.373  0.424 -0.221   -0.629   -0.300 -0.699
            t24C:. iI8:24C:
isolineIz8                 
isolineIz9                 
tempertr24C                
repr.typFOG                
islnIz8:24C                
islnIz9:24C                
islnI8:.FOG                
islnI9:.FOG                
tmp24C:.FOG                
iI8:24C:.FO -0.625         
iI9:24C:.FO -0.529  0.331  
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: d_2 ~ isoline * temperature * repr.type + (1 | population)
   Data: alldata_2

REML criterion at convergence: -55.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.3456 -0.5324 -0.0754  0.4152  3.5639 

Random effects:
 Groups     Name        Variance Std.Dev.
 population (Intercept) 0.00000  0.0000  
 Residual               0.01893  0.1376  
Number of obs: 80, groups:  population, 35

Fixed effects:
                                       Estimate Std. Error       df t value
(Intercept)                            -0.07398    0.04865 68.00000  -1.521
isolineIz8                              0.05132    0.07431 68.00000   0.691
isolineIz9                              0.50076    0.08426 68.00000   5.943
temperature24C                          0.05925    0.06527 68.00000   0.908
repr.typeFOG                            0.09333    0.07431 68.00000   1.256
isolineIz8:temperature24C              -0.06884    0.11022 68.00000  -0.625
isolineIz9:temperature24C              -0.39185    0.11022 68.00000  -3.555
isolineIz8:repr.typeFOG                -0.14814    0.10509 68.00000  -1.410
isolineIz9:repr.typeFOG                -0.24933    0.12243 68.00000  -2.037
temperature24C:repr.typeFOG            -0.06493    0.09273 68.00000  -0.700
isolineIz8:temperature24C:repr.typeFOG  0.25625    0.14835 68.00000   1.727
isolineIz9:temperature24C:repr.typeFOG  0.51977    0.17517 68.00000   2.967
                                       Pr(&gt;|t|)    
(Intercept)                            0.132962    
isolineIz8                             0.492187    
isolineIz9                             1.07e-07 ***
temperature24C                         0.367198    
repr.typeFOG                           0.213405    
isolineIz8:temperature24C              0.534366    
isolineIz9:temperature24C              0.000693 ***
isolineIz8:repr.typeFOG                0.163193    
isolineIz9:repr.typeFOG                0.045586 *  
temperature24C:repr.typeFOG            0.486186    
isolineIz8:temperature24C:repr.typeFOG 0.088653 .  
isolineIz9:temperature24C:repr.typeFOG 0.004146 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) islnI8 islnI9 tmp24C rp.FOG isI8:24C isI9:24C iI8:.F iI9:.F
isolineIz8  -0.655                                                            
isolineIz9  -0.577  0.378                                                     
tempertr24C -0.745  0.488  0.430                                              
repr.typFOG -0.655  0.429  0.378  0.488                                       
islnIz8:24C  0.441 -0.674 -0.255 -0.592 -0.289                                
islnIz9:24C  0.441 -0.289 -0.764 -0.592 -0.289  0.351                         
islnI8:.FOG  0.463 -0.707 -0.267 -0.345 -0.707  0.477    0.204                
islnI9:.FOG  0.397 -0.260 -0.688 -0.296 -0.607  0.175    0.526    0.429       
tmp24C:.FOG  0.525 -0.343 -0.303 -0.704 -0.801  0.417    0.417    0.567  0.486
iI8:24C:.FO -0.328  0.501  0.189  0.440  0.501 -0.743   -0.261   -0.708 -0.304
iI9:24C:.FO -0.278  0.182  0.481  0.373  0.424 -0.221   -0.629   -0.300 -0.699
            t24C:. iI8:24C:
isolineIz8                 
isolineIz9                 
tempertr24C                
repr.typFOG                
islnIz8:24C                
islnIz9:24C                
islnI8:.FOG                
islnI9:.FOG                
tmp24C:.FOG                
iI8:24C:.FO -0.625         
iI9:24C:.FO -0.529  0.331  
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: d_3 ~ isoline * temperature * repr.type + (1 | population)
   Data: alldata_2

REML criterion at convergence: -31

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.4977 -0.5537 -0.1069  0.5102  3.3330 

Random effects:
 Groups     Name        Variance Std.Dev.
 population (Intercept) 0.00000  0.0000  
 Residual               0.02717  0.1648  
Number of obs: 80, groups:  population, 35

Fixed effects:
                                       Estimate Std. Error       df t value
(Intercept)                            -0.09001    0.05827 68.00000  -1.545
isolineIz8                              0.05572    0.08901 68.00000   0.626
isolineIz9                              0.47604    0.10093 68.00000   4.716
temperature24C                          0.07288    0.07818 68.00000   0.932
repr.typeFOG                            0.12127    0.08901 68.00000   1.362
isolineIz8:temperature24C              -0.07232    0.13203 68.00000  -0.548
isolineIz9:temperature24C              -0.35980    0.13203 68.00000  -2.725
isolineIz8:repr.typeFOG                -0.21857    0.12588 68.00000  -1.736
isolineIz9:repr.typeFOG                -0.16758    0.14665 68.00000  -1.143
temperature24C:repr.typeFOG            -0.07670    0.11108 68.00000  -0.690
isolineIz8:temperature24C:repr.typeFOG  0.34893    0.17771 68.00000   1.963
isolineIz9:temperature24C:repr.typeFOG  0.46898    0.20984 68.00000   2.235
                                       Pr(&gt;|t|)    
(Intercept)                             0.12708    
isolineIz8                              0.53342    
isolineIz9                             1.24e-05 ***
temperature24C                          0.35452    
repr.typeFOG                            0.17758    
isolineIz8:temperature24C               0.58566    
isolineIz9:temperature24C               0.00816 ** 
isolineIz8:repr.typeFOG                 0.08704 .  
isolineIz9:repr.typeFOG                 0.25715    
temperature24C:repr.typeFOG             0.49225    
isolineIz8:temperature24C:repr.typeFOG  0.05368 .  
isolineIz9:temperature24C:repr.typeFOG  0.02871 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) islnI8 islnI9 tmp24C rp.FOG isI8:24C isI9:24C iI8:.F iI9:.F
isolineIz8  -0.655                                                            
isolineIz9  -0.577  0.378                                                     
tempertr24C -0.745  0.488  0.430                                              
repr.typFOG -0.655  0.429  0.378  0.488                                       
islnIz8:24C  0.441 -0.674 -0.255 -0.592 -0.289                                
islnIz9:24C  0.441 -0.289 -0.764 -0.592 -0.289  0.351                         
islnI8:.FOG  0.463 -0.707 -0.267 -0.345 -0.707  0.477    0.204                
islnI9:.FOG  0.397 -0.260 -0.688 -0.296 -0.607  0.175    0.526    0.429       
tmp24C:.FOG  0.525 -0.343 -0.303 -0.704 -0.801  0.417    0.417    0.567  0.486
iI8:24C:.FO -0.328  0.501  0.189  0.440  0.501 -0.743   -0.261   -0.708 -0.304
iI9:24C:.FO -0.278  0.182  0.481  0.373  0.424 -0.221   -0.629   -0.300 -0.699
            t24C:. iI8:24C:
isolineIz8                 
isolineIz9                 
tempertr24C                
repr.typFOG                
islnIz8:24C                
islnIz9:24C                
islnI8:.FOG                
islnI9:.FOG                
tmp24C:.FOG                
iI8:24C:.FO -0.625         
iI9:24C:.FO -0.529  0.331  
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(model3, <span class="sc">~</span>temperature<span class="sc">+</span>repr.type<span class="sc">|</span>isoline, <span class="at">CIs =</span> T,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIarg =</span> <span class="fu">list</span>(<span class="at">col =</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(model3, <span class="sc">~</span>temperature<span class="sc">+</span>repr.type, <span class="at">CIs =</span> T,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">CIarg =</span> <span class="fu">list</span>(<span class="at">col =</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The patterns largely agree with what we can see in the model.</p>
</section>
<section id="sampling-variances-and-meta-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sampling-variances-and-meta-analysis">Sampling variances and meta-analysis</h2>
<p>The sampling variances of subsequent effect sizes are based on several relationships. The sampling variances of raw proportions are (because we do not have <span class="math inline">\(N\)</span> for all cases - we will have to make some assumptions, probably not too bold anyways)</p>
<p><span class="math display">\[ var(p)=\frac{p(1-p)}{N}, \]</span></p>
<p>and variance of the average of 4 proportions is (from stats theory)</p>
<p><span class="math display">\[var(\hat{p}) = \frac{\sum_{i} var(p_{i})}{n^{2}} = \frac{1}{16}\sum_{i} var(p_{i}).\]</span> Variance of a difference of two proportions <span class="math inline">\(W_{1}=\hat{p}_{2}-\hat{p}_{1}\)</span> is (from the delta method) <span class="math inline">\(var(W_{1})=var(\hat{p}_{2})+var(\hat{p}_{1})\)</span>. We are ignoring here covariance of two proportions (which is reasonable, they should not covary in general ’casue are the result of (unpredictable) competition) - but above we also ignored covariance of 4 replicated proportion which may not be reasonable, in such case we would have to increase the estimate (maybe worth trying) assuming some correlation <span class="math inline">\(r\)</span>:</p>
<p><span class="math display">\[var(\hat{p}) = \frac{\sum_{i} var(p_{i}) + 2\sum_{i}\sum_{j&lt;1}cov(p_{i}p_{j})}{n^{2}} = \\ \frac{1}{16}\sum_{i} var(p_{i})+2\sum_{i}\sum_{j&gt;i}r \sqrt{var(p_{i})}\sqrt{var(p_{j})}.\]</span> This correction can be seen as an alternative to correcting for multiple comparisons (and it actually achieves what we need - decreases Type I error in zero-ES cases to roughly 5%).</p>
<p>Sampling variance of a log ratio is (from delta method):</p>
<p><span class="math display">\[var(W_{2}) = var[ln(\frac{\hat{p_{2}}}{\hat{p_{1}}})] = \\
[\frac{\partial}{\partial \hat{p_{2}}}(ln\:\hat{p_{2}}-ln\:\hat{p_{1}})]^{2}\:var(p_{2}) + \\
[\frac{\partial}{\partial \hat{p_{1}}}(ln\:\hat{p}_{2}-ln\:\hat{p}_{1})]^{2}\:var(\hat{p}_{1}) = \\ \frac{1}{\hat{p_{2}}^{2}}\:var(\hat{p_{2}})+\frac{1}{\hat{p_{1}}^{2}}\:var(\hat{p_{1}}).\]</span></p>
<p>And finally - using those variances and fitness estimates - we can calculate <span class="math inline">\(d\)</span> and it’s sampling variance (in the usual way):</p>
<p><span class="math display">\[d = \frac {{W_{x,ee}} - {W_{x,anc}}} {s_{pooled}}J,\]</span> <span class="math display">\[s_{pooled} = \sqrt{\frac{(n_{1}-1)\:var(W_{x,ee})+(n_{2}-1)\:var(W_{x,anc})}{n_{ee}+n_{anc}-2}},\]</span></p>
<p><span class="math display">\[J = 1-\frac{3}{4(n_{ee}+n_{anc}-2)-1}.\]</span></p>
<p>First - let’s calculate relevant effect sizes and sampling variances. We need to repeat the above calculations adding proportion sampling variance to original data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>correction <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">3</span><span class="sc">*</span><span class="fl">0.8</span><span class="sc">*</span><span class="fl">0.0005</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this correction assumes that on average variance of proportion estimation here is 0.0005</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (close to actual averages of 0.0003-0.0006) and that (due to coming from the same</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># realisation of breeding the 4 replicates are strongly correlated (r = 0.8)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># number 3 comes from the fact that in a 4x4 covariance matrix there are 3 correlations</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anc_pop <span class="sc">!=</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">varNstart =</span> (propN_start<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>propN_start))<span class="sc">/</span>sum,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">varN1 =</span> (propN_F1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>propN_F1))<span class="sc">/</span>(sum)) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(block_unique) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Nstart =</span> <span class="fu">mean</span>(propN_start),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_N1 =</span> <span class="fu">mean</span>(propN_F1),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">var_Nstart =</span> (<span class="fu">sum</span>(varNstart)<span class="sc">/</span><span class="dv">16</span>)<span class="sc">+</span>correction,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">var_N1 =</span> (<span class="fu">sum</span>(varN1)<span class="sc">/</span><span class="dv">16</span>)<span class="sc">+</span>correction,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">population =</span> <span class="fu">unique</span>(population),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">isoline =</span> <span class="fu">unique</span>(isoline),</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">temperature =</span> <span class="fu">unique</span>(temperature),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">repr.type =</span> <span class="fu">unique</span>(repr.type),</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">anc_pop =</span> <span class="fu">unique</span>(anc_pop),</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ancdata_2 <span class="ot">&lt;-</span> ancdata <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">varNstart =</span> (propN_start<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>propN_start))<span class="sc">/</span>sum,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">varN1 =</span> (propN_F1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>propN_F1))<span class="sc">/</span>(sum)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(block_unique) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Nstart_anc =</span> <span class="fu">mean</span>(propN_start),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_N1_anc =</span> <span class="fu">mean</span>(propN_F1),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">var_Nstart_anc =</span> (<span class="fu">sum</span>(varNstart)<span class="sc">/</span><span class="dv">16</span>)<span class="sc">+</span>correction,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">var_N1_anc =</span> (<span class="fu">sum</span>(varN1)<span class="sc">/</span><span class="dv">16</span>)<span class="sc">+</span>correction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Merge actual data and ancestral data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata_2 <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ancdata_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"anc_pop"</span> <span class="ot">=</span> <span class="st">"block_unique"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>anc_pop)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(alldata_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 13
$ block_unique    &lt;fct&gt; I.I_E02_Iz6, I.I_E05_Iz6, I.I_E06_Iz6, I.I_E08_Iz6, I.…
$ mean_Nstart     &lt;dbl&gt; 0.5818966, 0.5750916, 0.7437037, 0.6898734, 0.6875000,…
$ mean_N1         &lt;dbl&gt; 0.3776727, 0.4294794, 0.5099959, 0.3424359, 0.4647014,…
$ var_Nstart      &lt;dbl&gt; 0.002519465, 0.002639630, 0.002484285, 0.002524753, 0.…
$ var_N1          &lt;dbl&gt; 0.002514981, 0.002638783, 0.002510318, 0.002531016, 0.…
$ population      &lt;fct&gt; E02, E05, E06, E08, E09, E73, E74, E75, K11, K32, K60,…
$ isoline         &lt;fct&gt; Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6, Iz6,…
$ temperature     &lt;fct&gt; 24C, 24C, 24C, 24C, 24C, 24C, 24C, 24C, 20C, 20C, 20C,…
$ repr.type       &lt;fct&gt; FOG, FOG, FOG, FOG, FOG, WT, WT, WT, WT, WT, FOG, FOG,…
$ mean_Nstart_anc &lt;dbl&gt; 0.5939742, 0.5939742, 0.5939742, 0.5939742, 0.5939742,…
$ mean_N1_anc     &lt;dbl&gt; 0.3680913, 0.3680913, 0.3680913, 0.3680913, 0.3680913,…
$ var_Nstart_anc  &lt;dbl&gt; 0.002550122, 0.002550122, 0.002550122, 0.002550122, 0.…
$ var_N1_anc      &lt;dbl&gt; 0.002543473, 0.002543473, 0.002543473, 0.002543473, 0.…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata_2 <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitness_ee_1 =</span> mean_N1 <span class="sc">-</span> mean_Nstart,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_ee_2 =</span> <span class="fu">log</span>(mean_N1<span class="sc">/</span>mean_Nstart),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">var_f_ee_1 =</span> var_Nstart <span class="sc">+</span> var_N1,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">var_f_ee_2 =</span> (<span class="dv">1</span><span class="sc">/</span>mean_N1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>var_N1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>mean_Nstart<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>var_Nstart,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_anc_1 =</span> mean_N1_anc <span class="sc">-</span> mean_Nstart_anc,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitness_anc_2 =</span> <span class="fu">log</span>(mean_N1_anc<span class="sc">/</span>mean_Nstart_anc),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">var_f_anc_1 =</span> var_Nstart_anc <span class="sc">+</span> var_N1_anc,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">var_f_anc_2 =</span> (<span class="dv">1</span><span class="sc">/</span>mean_N1_anc<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>var_N1_anc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>mean_Nstart_anc<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>var_Nstart_anc,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">repr.type =</span> <span class="fu">relevel</span>(repr.type, <span class="at">ref =</span> <span class="st">"WT"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally let’s calculate Hedge’s <span class="math inline">\(g\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">3</span><span class="sc">/</span>(<span class="dv">4</span><span class="sc">*</span>(<span class="dv">4</span><span class="sc">+</span><span class="dv">4-2</span>) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> alldata_2 <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_1 =</span> J<span class="sc">*</span>(fitness_ee_1 <span class="sc">-</span> fitness_anc_1)<span class="sc">/</span><span class="fu">sqrt</span>((<span class="dv">3</span><span class="sc">*</span>var_f_ee_1 <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>var_f_anc_1)<span class="sc">/</span>(<span class="dv">4</span><span class="sc">+</span><span class="dv">4-2</span>)),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_2 =</span> J<span class="sc">*</span>(fitness_ee_2 <span class="sc">-</span> fitness_anc_2)<span class="sc">/</span><span class="fu">sqrt</span>((<span class="dv">3</span><span class="sc">*</span>var_f_ee_2 <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>var_f_anc_2)<span class="sc">/</span>(<span class="dv">4</span><span class="sc">+</span><span class="dv">4-2</span>)),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">var_d_1 =</span> (<span class="dv">8</span><span class="sc">/</span><span class="dv">16</span>)<span class="sc">+</span>(d_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">16</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">var_d_2 =</span> (<span class="dv">8</span><span class="sc">/</span><span class="dv">16</span>)<span class="sc">+</span>(d_2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">16</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="meta-analysis" class="level2">
<h2 class="anchored" data-anchor-id="meta-analysis">Meta-analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>alldata_2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(alldata_2, <span class="at">weight_1 =</span> <span class="dv">1</span><span class="sc">/</span>var_d_1, <span class="at">weight_2 =</span> <span class="dv">1</span><span class="sc">/</span>var_d_2)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>alldata_2<span class="sc">$</span>esid <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(alldata_2))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ES = difference in proportions</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(d_1 <span class="sc">~</span> isoline <span class="sc">*</span> temperature <span class="sc">*</span> repr.type,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>population,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                               <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>esid),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> alldata_2,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">V =</span> var_d_1)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 80; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-81.3927  162.7855  190.7855  221.8586  198.7100   

Variance Components:

            estim    sqrt  nlvls  fixed      factor 
sigma^2.1  0.0000  0.0000     35     no  population 
sigma^2.2  0.0000  0.0001     80     no        esid 

Test for Residual Heterogeneity:
QE(df = 68) = 77.4421, p-val = 0.2028

Test of Moderators (coefficients 2:12):
QM(df = 11) = 42.9071, p-val &lt; .0001

Model Results:

                                        estimate      se     zval    pval 
intrcpt                                  -0.5032  0.2597  -1.9371  0.0527 
isolineIz8                                0.4688  0.3985   1.1763  0.2395 
isolineIz9                                2.1836  0.4902   4.4542  &lt;.0001 
temperature24C                            0.3600  0.3488   1.0320  0.3021 
repr.typeFOG                              0.6847  0.3924   1.7449  0.0810 
isolineIz8:temperature24C                -0.6400  0.5851  -1.0938  0.2740 
isolineIz9:temperature24C                -1.7659  0.6200  -2.8482  0.0044 
isolineIz8:repr.typeFOG                  -0.9321  0.5593  -1.6666  0.0956 
isolineIz9:repr.typeFOG                  -1.3909  0.7060  -1.9701  0.0488 
temperature24C:repr.typeFOG              -0.5422  0.4911  -1.1040  0.2696 
isolineIz8:temperature24C:repr.typeFOG    1.7765  0.7880   2.2543  0.0242 
isolineIz9:temperature24C:repr.typeFOG    3.0495  1.0413   2.9286  0.0034 
                                          ci.lb    ci.ub      
intrcpt                                 -1.0122   0.0059    . 
isolineIz8                              -0.3123   1.2498      
isolineIz9                               1.2228   3.1445  *** 
temperature24C                          -0.3237   1.0437      
repr.typeFOG                            -0.0844   1.4538    . 
isolineIz8:temperature24C               -1.7869   0.5068      
isolineIz9:temperature24C               -2.9811  -0.5507   ** 
isolineIz8:repr.typeFOG                 -2.0283   0.1641    . 
isolineIz9:repr.typeFOG                 -2.7747  -0.0072    * 
temperature24C:repr.typeFOG             -1.5048   0.4204      
isolineIz8:temperature24C:repr.typeFOG   0.2319   3.3210    * 
isolineIz9:temperature24C:repr.typeFOG   1.0086   5.0904   ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(d_2 <span class="sc">~</span> isoline <span class="sc">*</span> temperature <span class="sc">*</span> repr.type,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>population,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                               <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>esid),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> alldata_2,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">V =</span> var_d_2)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 80; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-82.2477  164.4954  192.4954  223.5685  200.4199   

Variance Components:

            estim    sqrt  nlvls  fixed      factor 
sigma^2.1  0.0000  0.0000     35     no  population 
sigma^2.2  0.0252  0.1587     80     no        esid 

Test for Residual Heterogeneity:
QE(df = 68) = 78.9367, p-val = 0.1715

Test of Moderators (coefficients 2:12):
QM(df = 11) = 46.1937, p-val &lt; .0001

Model Results:

                                        estimate      se     zval    pval 
intrcpt                                  -0.5066  0.2656  -1.9076  0.0564 
isolineIz8                                0.4350  0.4063   1.0706  0.2843 
isolineIz9                                2.2553  0.5021   4.4921  &lt;.0001 
temperature24C                            0.3917  0.3566   1.0983  0.2721 
repr.typeFOG                              0.6391  0.4025   1.5877  0.1123 
isolineIz8:temperature24C                -0.5159  0.5969  -0.8643  0.3874 
isolineIz9:temperature24C                -1.7290  0.6347  -2.7241  0.0064 
isolineIz8:repr.typeFOG                  -1.1218  0.5737  -1.9552  0.0506 
isolineIz9:repr.typeFOG                  -1.4045  0.7205  -1.9494  0.0512 
temperature24C:repr.typeFOG              -0.4300  0.5040  -0.8532  0.3935 
isolineIz8:temperature24C:repr.typeFOG    1.8047  0.8071   2.2360  0.0254 
isolineIz9:temperature24C:repr.typeFOG    2.8437  1.0596   2.6838  0.0073 
                                          ci.lb    ci.ub      
intrcpt                                 -1.0270   0.0139    . 
isolineIz8                              -0.3614   1.2314      
isolineIz9                               1.2713   3.2394  *** 
temperature24C                          -0.3073   1.0906      
repr.typeFOG                            -0.1498   1.4281      
isolineIz8:temperature24C               -1.6857   0.6540      
isolineIz9:temperature24C               -2.9730  -0.4850   ** 
isolineIz8:repr.typeFOG                 -2.2463   0.0027    . 
isolineIz9:repr.typeFOG                 -2.8166   0.0076    . 
temperature24C:repr.typeFOG             -1.4177   0.5578      
isolineIz8:temperature24C:repr.typeFOG   0.2228   3.3865    * 
isolineIz9:temperature24C:repr.typeFOG   0.7669   4.9204   ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Forest plot of all effect sizes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>alldata_2<span class="sc">$</span>repro.temp <span class="ot">&lt;-</span> <span class="fu">interaction</span>(alldata_2<span class="sc">$</span>repr.type, alldata_2<span class="sc">$</span>temperature)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>densscale <span class="ot">&lt;-</span> <span class="fl">0.025</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>iso_labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Line 6"</span>, <span class="st">"Line 8"</span>, <span class="st">"Line 9"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iso_labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Iz6"</span>, <span class="st">"Iz8"</span>, <span class="st">"Iz9"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">arrange</span>(alldata_2, d_2)) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> d_2, <span class="at">y =</span> (..count..)<span class="sc">*</span>densscale<span class="sc">*</span><span class="fu">nrow</span>(alldata_2)),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="st">"gray"</span>, <span class="at">fill =</span> <span class="st">"gray95"</span>, <span class="at">trim =</span> F) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">'gray50'</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">x =</span> d_2, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(alldata_2),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> repro.temp)) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(alldata_2),</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmin =</span> d_2<span class="fl">-1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(var_d_2), <span class="at">xmax =</span> d_2<span class="fl">+1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(var_d_2),</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> repro.temp)) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue3"</span>, <span class="st">"purple3"</span>, <span class="st">"magenta"</span>, <span class="st">"firebrick1"</span>)) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Cohen</span><span class="sc">\'</span><span class="st">s d'</span>, <span class="at">y =</span> <span class="st">'Replicate ID'</span>, ) <span class="sc">+</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> isoline,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">isoline =</span> iso_labs)) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"oldlace"</span>, <span class="at">linewidth =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>